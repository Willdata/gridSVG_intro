<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>R Interactive Graphics with SVG</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<script src = 'http://d3js.org/d3.v3.js' meta-charset='utf-8'></script>

<h1>R Interactive Graphics with SVG</h1>

<p>It seems computer history is <a href="http://worrydream.com/#!/TheFutureOfProgramming">full of examples</a> of forgotten concepts from programmers ahead of their time.</p>

<h3>Before <a href="https://github.com/mbostock/d3/releases?after=v1.20.2">d3 (2011)</a> and Even <a href="http://mbostock.github.io/protovis/">Protovis (2009)</a></h3>

<p>Long before the 2011 release of <a href="http://d3js.org">d3.js</a> and 2009 launch of <a href="http://mbostock.github.io/protovis/">Protovis</a> and even before Hans Rosling&#39;s famous <a href="http://www.gapminder.org/">example</a>, the folks at <a href="http://www.carto.net/papers/">carto.net</a> were doing amazing and revolutionary interactive graphics in SVG.  Consider this 2006 <a href="http://www.carto.net/williams/yosemite/">Interactive Map of Yosemite</a> described in the <a href="http://www.carto.net/neumann/papers/2006/bohinj_slovenia_2006_williams_neumann.pdf">paper by Juliana Williams and Andreas Neumann</a>.</p>

<iframe height = "400"  width = "900" src = "http://www.carto.net/williams/yosemite/"></iframe>

<p>Building on this body of knowledge, some well known R contributors Deborah Nolan and Duncan Temple Lang (authors of the upcoming book <a href="http://www.amazon.com/gp/product/1461478995/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1461478995&linkCode=as2&tag=timelyp-20">XML and Web Technologies for Data Sciences with R (Use R!)</a><img src="http://ir-na.amazon-adsystem.com/e/ir?t=timelyp-20&l=as2&o=1&a=1461478995" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
) created the R package <code>SVGAnnotation</code> described in <strong>Journal of Statistical Software</strong> <em>Vol 46 Issue 1</em> (<a href="http://www.jstatsoft.org/v46/i01">submitted paper</a> and <a href="http://www.omegahat.org/SVGAnnotation/SVGAnnotationPaper/SVGAnnotationPaper.html#bib:SVGAnnotation">html version</a>).  The article demonstrates how to achieve SVG interactivity straight from R still a year before <a href="http://d3js.org">d3.js</a> first release.  Embedded below are two examples of <a href="http://www.omegahat.org/SVGAnnotation/SVGAnnotationPaper/XMLExamples/quakes_tips.svg">many</a>, each created directly from R.  You should see some animation and tooltips on hover.</p>

<iframe height = "400"  width = "900" src = "http://www.omegahat.org/SVGAnnotation/SVGAnnotationPaper/XMLExamples/gapM.svg"></iframe>

<iframe height = "400"  width = "900" src = "http://www.omegahat.org/SVGAnnotation/SVGAnnotationPaper/XMLExamples/quakes_tips.svg"></iframe>

<p>Now let&#39;s fast forward 3 years to 2013 where the concept of the HTML5/SVG/javascript combination for interactive graphics is <a href="https://github.com/popular/starred">ultra popular</a> and <a href="http://biovisualize.github.io/d3visualization/">well established</a> through <a href="http://d3js.org">d3.js</a>.  The novel element of d3 is its ability to bind data to elements of a document to create the 3 d&#39;s of d3&ndash;data-driven documents.</p>

<h2>Just a Little Bit of Glue</h2>

<p>For R, we just need a little bit of glue to blend the old with the new to directly harness the power of SVG interactivity and d3 data binding.  It seems there are 3 types of glue available:</p>

<ol>
<li><p>Let R do the data and then send the data to Javascript to create the SVG graphics.  This is the process employed by <a href="http://rcharts.io/site">rCharts</a>, <a href="http://rclickme.com/">clickme</a>, <a href="http://christophergandrud.github.io/d3Network/">d3network</a>, <a href="http://cran.r-project.org/web/packages/googleVis/index.html">googleVis</a>, <a href="https://github.com/rstudio/gigvis">gigvis</a>, and <a href="http://cran.r-project.org/web/packages/tabplotd3/index.html">tabplotd3</a>.</p></li>
<li><p>Let R both do the data and render the graph then export the SVG to get interactivity from Javascript.  We see this with the new and improved <a href="http://sjp.co.nz/projects/gridsvg/">gridSVG</a> and the previously mentioned <a href="http://www.omegahat.org/SVGAnnotation/SVGAnnotationPaper/SVGAnnotationPaper.html#bib:SVGAnnotation">SVGAnnotation</a>.</p></li>
<li><p>Use 1. or 2. and then maintain bidirectional communication between R and Javascript through <a href="http://rstudio.com/shiny">shiny</a>, <a href="http://cran.r-project.org/web/packages/Rook/index.html">Rook</a>, or some other web server type interface.</p></li>
</ol>

<p>I believe the choice of method will depend on the user&#39;s competence in R and/or Javascript, their desire for customization, and the need for R&#39;s data calculation abilities post-render.  I have posted a lot about using method 1 with rCharts and clickme, so I wanted to start a series of demos using method 2.  Method 3 is fairly trivial with the full-featured Shiny and Rook once we have 1 and 2 conquered.</p>

<h2>Method 2 | R Draw and Render SVG with a d3 Reverse Data Bind</h2>

<p>Much of the R to SVG is already shown <a href="http://stattech.wordpress.fos.auckland.ac.nz/">in this blog</a> from the R Mecca in New Zealand.  As Simon Potter has extended SVGAnnotation while improving gridSVG, he has documented the process and the improvements on the same blog and in his soon-to-be-marked Masters&#39; thesis.  Since there are still few examples of the data bind step that we know and love from d3 but in reverse, I thought I would share a quick experiment doing a reverse data bind using d3 on a R/gridSVG exported graph.  For those not familiar with d3, Mike Bostock&#39;s <a href="http://mbostock.github.io/d3/tutorial/circle.html">Three Little Circles</a> will be very helpful.</p>

<p>If we choose gridSVG, we lose <code>base</code> graphics (SVGAnnotation does allow <code>base</code>), but I believe its advantages overcome this loss, and we still have the super-powerful <code>grid</code> graphics libraries <code>lattice</code> and <code>ggplot2</code>.  For this example, I will build on top of a ggplot2 scatter plot example from Winston Chang&#39;s <a href="http://www.cookbook-r.com/Graphs/Scatterplots_(ggplot2">Cookbook from R</a>).  This is the supporting website for his book</p>

<p><iframe src="http://rcm-na.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS1=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=timelyp-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=1449316956" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>.</p>

<p>Here is the slightly modified code that will produce our starting chart.  I will keep the smoothing even though we will not use it to show how we can preserve some R features not implemented as well in javascript.  Now would be a good time to get the newest gridSVG with <code>install.packages(&quot;gridSVG&quot;, repos=&quot;http://R-Forge.R-project.org&quot;)</code>.</p>

<pre><code class="r">#get the latest version of gridSVG
#install.packages(&quot;gridSVG&quot;, repos=&quot;http://R-Forge.R-project.org&quot;)

require(ggplot2)

set.seed(955)
# Make some noisily increasing data
dat &lt;- data.frame(cond = rep(c(&quot;A&quot;, &quot;B&quot;), each=10),
                  xvar = 1:20 + rnorm(20,sd=3),
                  yvar = 1:20 + rnorm(20,sd=3))
# cond         xvar         yvar
#    A -4.252354091  3.473157275
#    A  1.702317971  0.005939612
#   ... 
#    B 17.793359218 19.718587761
#    B 19.319909163 19.647899863

g4 &lt;- ggplot(dat, aes(x=xvar, y=yvar)) +
  geom_point(shape=19, aes(color = cond), size=5) +    # Use hollow circles
  geom_smooth()

g4
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/> </p>

<p>There are lots of ways that we might add a tooltip if that is all we want.  However, I think we will want more than just tooltips, so a full d3-style data bind will be a fine way to achieve this extra functionality.  When we export our graphic, we will get an impercetibly SVG copy of our ggplot2 graphic above.  If you don&#39;t believe it is SVG, left-click on the graphic and Inspect Element.  I told you it was SVG.  If you still don&#39;t believe me, zoom in to 400% and see if you can tell a difference between SVG and png.</p>

<pre><code class="r">require(gridSVG)
#print our ggplot2 graphic again
g4
#export to SVG file and R object
#grid.export deprecates the older gridToSVG
g4.svg &lt;- grid.export(&quot;plot1.svg&quot;,addClasses=TRUE)
#print our newly exported SVG inline
cat(saveXML(g4.svg$svg))
</code></pre>

<p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="720px" height="288px" viewBox="0 0 720 288" version="1.1">
  <metadata xmlns:gridsvg="http://www.stat.auckland.ac.nz/~paul/R/gridSVG/">
    <gridsvg:generator name="gridSVG" version="1.3-0" time="2013-08-05 17:13:15"/>
    <gridsvg:argument name="name" value="plot1.svg"/>
    <gridsvg:argument name="exportCoords" value="none"/>
    <gridsvg:argument name="exportMappings" value="none"/>
    <gridsvg:argument name="exportJS" value="none"/>
    <gridsvg:argument name="res" value="72"/>
    <gridsvg:argument name="prefix" value=""/>
    <gridsvg:argument name="addClasses" value="TRUE"/>
    <gridsvg:argument name="indent" value="TRUE"/>
    <gridsvg:argument name="htmlWrapper" value="FALSE"/>
    <gridsvg:argument name="usePaths" value="vpPaths"/>
    <gridsvg:argument name="uniqueNames" value="TRUE"/>
    <gridsvg:separator name="id.sep" value="."/>
    <gridsvg:separator name="gPath.sep" value="::"/>
    <gridsvg:separator name="vpPath.sep" value="::"/>
  </metadata>
  <g transform="translate(0, 288) scale(1, -1)">
    <g id="gridSVG" fill="none" stroke="rgb(0,0,0)" stroke-dasharray="none" stroke-width="0.75" font-size="12" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" opacity="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="0" font-weight="normal" font-style="normal">
      <defs>
        <symbol id="gridSVG.pch19" viewBox="-5 -5 10 10" overflow="visible">
          <circle cx="0" cy="0" r="3.75"/>
        </symbol>
      </defs>
      <g id="layout.1" class="pushedvp viewport">
        <g id="GRID.gTableParent.120.1" class="gTableParent gTree grob gDesc">
          <defs>
            <clipPath id="layout::background.1-6-6-1.1.clipPath">
              <rect x="0" y="0" width="720" height="288" fill="none" stroke="none"/>
            </clipPath>
          </defs>
          <g id="layout::background.1-6-6-1.1" clip-path="url(#layout::background.1-6-6-1.1.clipPath)" class="pushedvp viewport">
            <g id="background.1-6-6-1.1" class="gTableChild rect grob gDesc">
              <rect id="background.1-6-6-1.1.1" x="0" y="0" width="720" height="288" stroke-width="1.06" stroke="rgb(255,255,255)" fill="rgb(255,255,255)" stroke-dasharray="none" stroke-opacity="1" fill-opacity="1"/>
            </g>
          </g>
          <g id="layout::spacer.4-3-4-3.1" class="pushedvp viewport"/>
          <defs>
            <clipPath id="layout::panel.3-4-3-4.1.clipPath">
              <rect x="41.22" y="37.28" width="609.69" height="236.32" fill="none" stroke="none"/>
            </clipPath>
          </defs>
          <g id="layout::panel.3-4-3-4.1" clip-path="url(#layout::panel.3-4-3-4.1.clipPath)" class="pushedvp viewport">
            <g id="panel.3-4-3-4.1" class="gTableChild gTree grob gDesc">
              <g id="grill.gTree.84.1" class="gTree grob gDesc">
                <g id="panel.background.rect.75.1" class="rect grob gDesc">
                  <rect id="panel.background.rect.75.1.1" x="41.22" y="37.28" width="609.69" height="236.32" stroke-width="1.06" stroke="none" fill="rgb(229,229,229)" stroke-dasharray="none" stroke-opacity="0" fill-opacity="1"/>
                </g>
                <g id="panel.grid.minor.y.polyline.77.1" class="polyline grob gDesc">
                  <polyline id="panel.grid.minor.y.polyline.77.1.1" points="41.22,62.03 650.92,62.03" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.y.polyline.77.1.2" points="41.22,118.9 650.92,118.9" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.y.polyline.77.1.3" points="41.22,175.76 650.92,175.76" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.y.polyline.77.1.4" points="41.22,232.63 650.92,232.63" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                </g>
                <g id="panel.grid.minor.x.polyline.79.1" class="polyline grob gDesc">
                  <polyline id="panel.grid.minor.x.polyline.79.1.1" points="110.14,37.28 110.14,273.6" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.x.polyline.79.1.2" points="227.71,37.28 227.71,273.6" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.x.polyline.79.1.3" points="345.28,37.28 345.28,273.6" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.x.polyline.79.1.4" points="462.84,37.28 462.84,273.6" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.minor.x.polyline.79.1.5" points="580.41,37.28 580.41,273.6" stroke-width="0.53" stroke="rgb(242,242,242)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                </g>
                <g id="panel.grid.major.y.polyline.81.1" class="polyline grob gDesc">
                  <polyline id="panel.grid.major.y.polyline.81.1.1" points="41.22,90.46 650.92,90.46" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.y.polyline.81.1.2" points="41.22,147.33 650.92,147.33" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.y.polyline.81.1.3" points="41.22,204.2 650.92,204.2" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.y.polyline.81.1.4" points="41.22,261.07 650.92,261.07" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                </g>
                <g id="panel.grid.major.x.polyline.83.1" class="polyline grob gDesc">
                  <polyline id="panel.grid.major.x.polyline.83.1.1" points="51.36,37.28 51.36,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.x.polyline.83.1.2" points="168.92,37.28 168.92,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.x.polyline.83.1.3" points="286.49,37.28 286.49,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.x.polyline.83.1.4" points="404.06,37.28 404.06,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.x.polyline.83.1.5" points="521.63,37.28 521.63,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                  <polyline id="panel.grid.major.x.polyline.83.1.6" points="639.19,37.28 639.19,273.6" stroke-width="1.06" stroke="rgb(255,255,255)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                </g>
              </g>
              <g id="geom_point.points.66.1" class="points grob gDesc">
                <use id="geom_point.points.66.1.1" xlink:href="#gridSVG.pch19" x="68.94" y="110.21" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.2" xlink:href="#gridSVG.pch19" x="208.95" y="90.5" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.3" xlink:href="#gridSVG.pch19" x="270.57" y="89.93" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.4" xlink:href="#gridSVG.pch19" x="210.79" y="102.25" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.5" xlink:href="#gridSVG.pch19" x="440.21" y="97.37" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.6" xlink:href="#gridSVG.pch19" x="325.81" y="110.98" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.7" xlink:href="#gridSVG.pch19" x="169.02" y="133.28" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.8" xlink:href="#gridSVG.pch19" x="403.39" y="125.47" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.9" xlink:href="#gridSVG.pch19" x="380.72" y="141.28" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.10" xlink:href="#gridSVG.pch19" x="445.61" y="141.23" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.11" xlink:href="#gridSVG.pch19" x="376.79" y="165.54" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.12" xlink:href="#gridSVG.pch19" x="309.4" y="190.81" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.13" xlink:href="#gridSVG.pch19" x="522.45" y="150.09" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.14" xlink:href="#gridSVG.pch19" x="427.22" y="148.12" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.15" xlink:href="#gridSVG.pch19" x="487.37" y="196.7" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.16" xlink:href="#gridSVG.pch19" x="437.82" y="199.33" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.17" xlink:href="#gridSVG.pch19" x="568.11" y="197.56" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.18" xlink:href="#gridSVG.pch19" x="573.83" y="198.17" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.19" xlink:href="#gridSVG.pch19" x="587.31" y="202.6" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                <use id="geom_point.points.66.1.20" xlink:href="#gridSVG.pch19" x="623.2" y="202.2" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
              </g>
              <g id="smooths.gTree.71.1" class="gTree grob gDesc">
                <g id="geom_ribbon.polygon.68.1" class="polygon grob gDesc">
                  <polygon id="geom_ribbon.polygon.68.1.1" points="68.94,177.15 75.95,172.15 82.97,167.52 89.98,163.26 97,159.37 104.02,155.86 111.03,152.73 118.05,149.98 125.06,147.61 132.08,145.62 139.1,143.99 146.11,142.72 153.13,141.78 160.14,141.15 167.16,140.79 174.18,140.69 181.19,140.8 188.21,141.09 195.22,141.53 202.24,142.09 209.26,142.75 216.27,143.47 223.29,144.26 230.3,145.21 237.32,146.38 244.34,147.82 251.35,149.52 258.37,151.41 265.39,153.38 272.4,155.26 279.42,156.88 286.43,158.22 293.45,159.33 300.47,160.26 307.48,161.09 314.5,161.88 321.51,162.7 328.53,163.6 335.55,164.62 342.56,165.76 349.58,166.99 356.59,168.24 363.61,169.45 370.63,170.52 377.64,171.35 384.66,171.47 391.67,171.32 398.69,171.55 405.71,172.21 412.72,172.59 419.74,172.95 426.75,173.71 433.77,174.97 440.79,176.54 447.8,178.25 454.82,180.3 461.83,182.92 468.85,186.07 475.87,189.47 482.88,192.65 489.9,195.18 496.91,197.44 503.93,199.63 510.95,201.76 517.96,203.84 524.98,205.89 531.99,207.93 539.01,209.98 546.03,212.05 553.04,214.19 560.06,216.45 567.08,218.93 574.09,221.75 581.11,225.15 588.12,229.32 595.14,234.35 602.16,240.26 609.17,247.02 616.19,254.57 623.2,262.86 623.2,154.69 616.19,158.39 609.17,161.38 602.16,163.57 595.14,164.91 588.12,165.37 581.11,164.96 574.09,163.75 567.08,161.85 560.06,159.44 553.04,156.68 546.03,153.71 539.01,150.62 531.99,147.49 524.98,144.39 517.96,141.38 510.95,138.52 503.93,135.86 496.91,133.45 489.9,131.37 482.88,129.76 475.87,128.81 468.85,128.13 461.83,127.36 454.82,126.29 447.8,125 440.79,123.77 433.77,123 426.75,122.5 419.74,121.84 412.72,120.86 405.71,119.68 398.69,118.8 391.67,118.45 384.66,117.89 377.64,116.79 370.63,115.4 363.61,114.06 356.59,112.69 349.58,111.22 342.56,109.6 335.55,107.79 328.53,105.8 321.51,103.64 314.5,101.37 307.48,99.07 300.47,96.82 293.45,94.72 286.43,92.87 279.42,91.34 272.4,90.2 265.39,89.4 258.37,88.64 251.35,87.8 244.34,86.83 237.32,85.72 230.3,84.52 223.29,83.33 216.27,82.28 209.26,81.49 202.24,80.91 195.22,80.36 188.21,79.8 181.19,79.21 174.18,78.57 167.16,77.85 160.14,77.01 153.13,76.02 146.11,74.86 139.1,73.51 132.08,71.96 125.06,70.18 118.05,68.17 111.03,65.94 104.02,63.49 97,60.81 89.98,57.92 82.97,54.82 75.95,51.52 68.94,48.02" fill="rgb(153,153,153)" stroke="none" stroke-width="1.06" stroke-dasharray="none" stroke-opacity="0" fill-opacity="0.4"/>
                </g>
                <g id="GRID.polyline.69.1" class="polyline grob gDesc">
                  <polyline id="GRID.polyline.69.1.1" points="68.94,112.59 75.95,111.84 82.97,111.17 89.98,110.59 97,110.09 104.02,109.68 111.03,109.34 118.05,109.08 125.06,108.9 132.08,108.79 139.1,108.75 146.11,108.79 153.13,108.9 160.14,109.08 167.16,109.32 174.18,109.63 181.19,110.01 188.21,110.44 195.22,110.94 202.24,111.5 209.26,112.12 216.27,112.87 223.29,113.8 230.3,114.87 237.32,116.05 244.34,117.33 251.35,118.66 258.37,120.02 265.39,121.39 272.4,122.73 279.42,124.11 286.43,125.55 293.45,127.03 300.47,128.54 307.48,130.08 314.5,131.62 321.51,133.17 328.53,134.7 335.55,136.21 342.56,137.68 349.58,139.1 356.59,140.46 363.61,141.75 370.63,142.96 377.64,144.07 384.66,144.68 391.67,144.89 398.69,145.17 405.71,145.94 412.72,146.72 419.74,147.4 426.75,148.11 433.77,148.98 440.79,150.15 447.8,151.62 454.82,153.3 461.83,155.14 468.85,157.1 475.87,159.14 482.88,161.21 489.9,163.28 496.91,165.45 503.93,167.74 510.95,170.14 517.96,172.61 524.98,175.14 531.99,177.71 539.01,180.3 546.03,182.88 553.04,185.44 560.06,187.95 567.08,190.39 574.09,192.75 581.11,195.05 588.12,197.35 595.14,199.63 602.16,201.91 609.17,204.2 616.19,206.48 623.2,208.77" stroke="rgb(51,102,255)" fill="none" stroke-width="1.06" stroke-dasharray="none" stroke-linecap="butt" stroke-linejoin="round" stroke-miterlimit="1" stroke-opacity="1" fill-opacity="1"/>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::axis-l.3-3-3-3.1" class="pushedvp viewport">
            <g id="layout::axis-l.3-3-3-3::GRID.VP.6.1" class="pushedvp viewport">
              <g id="axis-l.3-3-3-3.1" class="gTableChild absoluteGrob gTree grob gDesc">
                <g id="layout::axis-l.3-3-3-3::GRID.VP.6::axis.1" class="pushedvp viewport">
                  <g id="GRID.gTableParent.125.1" class="gTableParent gTree grob gDesc">
                    <g id="layout::axis-l.3-3-3-3::GRID.VP.6::axis::axis.1-1-1-1.1" class="pushedvp viewport">
                      <g id="axis.1-1-1-1.1" class="gTableChild text grob gDesc">
                        <g id="axis.1-1-1-1.1.1" transform="translate(34.14, 90.46)" stroke-width="0.1">
                          <g id="axis.1-1-1-1.1.1.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.1-1-1-1.1.1.text" text-anchor="end" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.1-1-1-1.1.1.tspan.1" dy="3.59" x="0">0</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.1-1-1-1.1.2" transform="translate(34.14, 147.33)" stroke-width="0.1">
                          <g id="axis.1-1-1-1.1.2.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.1-1-1-1.1.2.text" text-anchor="end" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.1-1-1-1.1.2.tspan.1" dy="3.59" x="0">10</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.1-1-1-1.1.3" transform="translate(34.14, 204.2)" stroke-width="0.1">
                          <g id="axis.1-1-1-1.1.3.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.1-1-1-1.1.3.text" text-anchor="end" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.1-1-1-1.1.3.tspan.1" dy="3.59" x="0">20</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.1-1-1-1.1.4" transform="translate(34.14, 261.07)" stroke-width="0.1">
                          <g id="axis.1-1-1-1.1.4.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.1-1-1-1.1.4.text" text-anchor="end" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.1-1-1-1.1.4.tspan.1" dy="3.59" x="0">30</tspan>
                            </text>
                          </g>
                        </g>
                      </g>
                    </g>
                    <g id="layout::axis-l.3-3-3-3::GRID.VP.6::axis::axis.1-2-1-2.1" class="pushedvp viewport">
                      <g id="axis.1-2-1-2.1" class="gTableChild polyline grob gDesc">
                        <polyline id="axis.1-2-1-2.1.1" points="36.97,90.46 41.22,90.46" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-2-1-2.1.2" points="36.97,147.33 41.22,147.33" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-2-1-2.1.3" points="36.97,204.2 41.22,204.2" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-2-1-2.1.4" points="36.97,261.07 41.22,261.07" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::axis-b.4-4-4-4.1" class="pushedvp viewport">
            <g id="layout::axis-b.4-4-4-4::GRID.VP.5.1" class="pushedvp viewport">
              <g id="axis-b.4-4-4-4.1" class="gTableChild absoluteGrob gTree grob gDesc">
                <g id="layout::axis-b.4-4-4-4::GRID.VP.5::axis.1" class="pushedvp viewport">
                  <g id="GRID.gTableParent.131.1" class="gTableParent gTree grob gDesc">
                    <g id="layout::axis-b.4-4-4-4::GRID.VP.5::axis::axis.1-1-1-1.1" class="pushedvp viewport">
                      <g id="axis.1-1-1-1.2" class="gTableChild polyline grob gDesc">
                        <polyline id="axis.1-1-1-1.2.1" points="51.36,33.03 51.36,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-1-1-1.2.2" points="168.92,33.03 168.92,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-1-1-1.2.3" points="286.49,33.03 286.49,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-1-1-1.2.4" points="404.06,33.03 404.06,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-1-1-1.2.5" points="521.63,33.03 521.63,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                        <polyline id="axis.1-1-1-1.2.6" points="639.19,33.03 639.19,37.28" stroke-width="1.06" stroke="rgb(127,127,127)" stroke-dasharray="none" stroke-linecap="butt" stroke-opacity="1" fill="none"/>
                      </g>
                    </g>
                    <g id="layout::axis-b.4-4-4-4::GRID.VP.5::axis::axis.2-1-2-1.1" class="pushedvp viewport">
                      <g id="axis.2-1-2-1.1" class="gTableChild text grob gDesc">
                        <g id="axis.2-1-2-1.1.1" transform="translate(51.36, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.1.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.1.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.1.tspan.1" dy="7.18" x="0">-5</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.2-1-2-1.1.2" transform="translate(168.92, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.2.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.2.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.2.tspan.1" dy="7.18" x="0">0</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.2-1-2-1.1.3" transform="translate(286.49, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.3.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.3.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.3.tspan.1" dy="7.18" x="0">5</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.2-1-2-1.1.4" transform="translate(404.06, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.4.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.4.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.4.tspan.1" dy="7.18" x="0">10</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.2-1-2-1.1.5" transform="translate(521.63, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.5.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.5.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.5.tspan.1" dy="7.18" x="0">15</tspan>
                            </text>
                          </g>
                        </g>
                        <g id="axis.2-1-2-1.1.6" transform="translate(639.19, 30.2)" stroke-width="0.1">
                          <g id="axis.2-1-2-1.1.6.scale" transform="scale(1, -1)">
                            <text x="0" y="0" id="axis.2-1-2-1.1.6.text" text-anchor="middle" font-size="9.6" stroke="rgb(127,127,127)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(127,127,127)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                              <tspan id="axis.2-1-2-1.1.6.tspan.1" dy="7.18" x="0">20</tspan>
                            </text>
                          </g>
                        </g>
                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::xlab.5-4-5-4.1" class="pushedvp viewport">
            <g id="xlab.5-4-5-4.1" class="gTableChild text grob gDesc">
              <g id="xlab.5-4-5-4.1.1" transform="translate(346.07, 15.11)" stroke-width="0.1">
                <g id="xlab.5-4-5-4.1.1.scale" transform="scale(1, -1)">
                  <text x="0" y="0" id="xlab.5-4-5-4.1.1.text" text-anchor="middle" font-size="12" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                    <tspan id="xlab.5-4-5-4.1.1.tspan.1" dy="4.31" x="0">xvar</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::ylab.3-2-3-2.1" class="pushedvp viewport">
            <g id="ylab.3-2-3-2.1" class="gTableChild text grob gDesc">
              <g id="ylab.3-2-3-2.1.1" transform="translate(15.11, 155.44)" stroke-width="0.1">
                <g id="ylab.3-2-3-2.1.1.scale" transform="scale(1, -1)">
                  <text x="0" y="0" id="ylab.3-2-3-2.1.1.text" transform="rotate(-90)" text-anchor="middle" font-size="12" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                    <tspan id="ylab.3-2-3-2.1.1.tspan.1" dy="4.31" x="0">yvar</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::guide-box.3-5-3-5.1" class="pushedvp viewport">
            <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5.1" class="pushedvp viewport">
              <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5.1" class="pushedvp viewport">
                <g id="GRID.gTableChild.143.1" class="gTableChild gTableParent gTree grob gDesc">
                  <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2.1" class="pushedvp viewport">
                    <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2.1" class="pushedvp viewport">
                      <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2.1" class="pushedvp viewport">
                        <g id="GRID.gTableChild.144.1" class="gTableChild gTableParent gTree grob gDesc">
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::background.1-6-6-1.1" class="pushedvp viewport">
                            <g id="background.1-6-6-1.2" class="gTableChild rect grob gDesc">
                              <rect id="background.1-6-6-1.2.1" x="660.95" y="128.16" width="34.61" height="54.56" stroke-width="1.06" stroke="none" fill="rgb(255,255,255)" stroke-dasharray="none" stroke-opacity="0" fill-opacity="1"/>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::title.2-5-2-2.1" class="pushedvp viewport">
                            <g id="title.2-5-2-2.1" class="gTableChild text grob gDesc">
                              <g id="title.2-5-2-2.1.1" transform="translate(665.2, 174.88)" stroke-width="0.1">
                                <g id="title.2-5-2-2.1.1.scale" transform="scale(1, -1)">
                                  <text x="0" y="0" id="title.2-5-2-2.1.1.text" text-anchor="start" font-size="9.6" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="bold" font-style="normal">
                                    <tspan id="title.2-5-2-2.1.1.tspan.1" dy="3.59" x="0">cond</tspan>
                                  </text>
                                </g>
                              </g>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::key-3-1-bg.4-2-4-2.1" class="pushedvp viewport">
                            <g id="key-3-1-bg.4-2-4-2.1" class="gTableChild rect grob gDesc">
                              <rect id="key-3-1-bg.4-2-4-2.1.1" x="665.2" y="149.69" width="17.28" height="17.28" stroke-width="1.06" stroke="rgb(255,255,255)" fill="rgb(242,242,242)" stroke-dasharray="none" stroke-opacity="1" fill-opacity="1"/>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::key-3-1-1.4-2-4-2.1" class="pushedvp viewport">
                            <g id="key-3-1-1.4-2-4-2.1" class="gTableChild points grob gDesc">
                              <use id="key-3-1-1.4-2-4-2.1.1" xlink:href="#gridSVG.pch19" x="673.84" y="158.33" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(248,118,109)" fill="rgb(248,118,109)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::key-4-1-bg.5-2-5-2.1" class="pushedvp viewport">
                            <g id="key-4-1-bg.5-2-5-2.1" class="gTableChild rect grob gDesc">
                              <rect id="key-4-1-bg.5-2-5-2.1.1" x="665.2" y="132.41" width="17.28" height="17.28" stroke-width="1.06" stroke="rgb(255,255,255)" fill="rgb(242,242,242)" stroke-dasharray="none" stroke-opacity="1" fill-opacity="1"/>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::key-4-1-1.5-2-5-2.1" class="pushedvp viewport">
                            <g id="key-4-1-1.5-2-5-2.1" class="gTableChild points grob gDesc">
                              <use id="key-4-1-1.5-2-5-2.1.1" xlink:href="#gridSVG.pch19" x="673.84" y="141.05" width="14.17" height="14.17" transform="translate(-7.09,-7.09)" stroke="rgb(0,191,196)" fill="rgb(0,191,196)" font-size="14.17" stroke-width="0.53" stroke-opacity="1" fill-opacity="1"/>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::label-3-3.4-4-4-4.1" class="pushedvp viewport">
                            <g id="label-3-3.4-4-4-4.1" class="gTableChild text grob gDesc">
                              <g id="label-3-3.4-4-4-4.1.1" transform="translate(684.64, 158.33)" stroke-width="0.1">
                                <g id="label-3-3.4-4-4-4.1.1.scale" transform="scale(1, -1)">
                                  <text x="0" y="0" id="label-3-3.4-4-4-4.1.1.text" text-anchor="start" font-size="9.6" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                                    <tspan id="label-3-3.4-4-4-4.1.1.tspan.1" dy="3.59" x="0">A</tspan>
                                  </text>
                                </g>
                              </g>
                            </g>
                          </g>
                          <g id="layout::guide-box.3-5-3-5::guide-box.3-5-3-5::guide-box.3-5-3-5::guides.2-2-2-2::guides.2-2-2-2::guides.2-2-2-2::label-4-3.5-4-5-4.1" class="pushedvp viewport">
                            <g id="label-4-3.5-4-5-4.1" class="gTableChild text grob gDesc">
                              <g id="label-4-3.5-4-5-4.1.1" transform="translate(684.64, 141.05)" stroke-width="0.1">
                                <g id="label-4-3.5-4-5-4.1.1.scale" transform="scale(1, -1)">
                                  <text x="0" y="0" id="label-4-3.5-4-5-4.1.1.text" text-anchor="start" font-size="9.6" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                                    <tspan id="label-4-3.5-4-5-4.1.1.tspan.1" dy="3.59" x="0">B</tspan>
                                  </text>
                                </g>
                              </g>
                            </g>
                          </g>
                        </g>
                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </g>
          </g>
          <g id="layout::title.2-4-2-4.1" class="pushedvp viewport">
            <g id="title.2-4-2-4.1" class="gTableChild text grob gDesc">
              <g id="title.2-4-2-4.1.1" transform="translate(346.07, 273.6)" stroke-width="0.1">
                <g id="title.2-4-2-4.1.1.scale" transform="scale(1, -1)">
                  <text x="0" y="0" id="title.2-4-2-4.1.1.text" text-anchor="middle" font-size="14.4" stroke="rgb(0,0,0)" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(0,0,0)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal">
                    <tspan id="title.2-4-2-4.1.1.tspan.1" dy="5.03" x="0"> </tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
        </g>
      </g>
    </g>
  </g>
</svg></p>

<p>Of course the objective is to get more than just a more scalable graphic.  Let&#39;s bind some data to get some simple tooltips.  ggplot2 stores the data for our graph within our <code>g4</code> object.  We can see it.</p>

<p>List of 9
 $ data       :&#39;data.frame&#39;:    20 obs. of  3 variables:
  ..$ cond: Factor w/ 2 levels &ldquo;A&rdquo;,&ldquo;B&rdquo;: 1 1 1 1 1 1 1 1 1 1 &hellip;
  ..$ xvar: num [1:20] -4.25 1.7 4.32 1.78 11.54 &hellip;
  ..$ yvar: num [1:20] 3.47316 0.00594 -0.09425 2.07281 1.21544 &hellip;
 $ layers     :List of 2
  ..$ :Classes &#39;proto&#39;, &#39;environment&#39; <environment: 0x0000000009526f20> 
  ..$ :Classes &#39;proto&#39;, &#39;environment&#39; <environment: 0x00000000095f7598> 
 $ scales     :Reference class &#39;Scales&#39; [package &ldquo;ggplot2&rdquo;] with 1 fields
  ..$ scales: list()
  ..and 21 methods, of which 9 are possibly relevant:
  ..  add, clone, find, get_scales, has_scale, initialize, input, n,
  ..  non_position_scales
 $ mapping    :List of 2
  ..$ x: symbol xvar
  ..$ y: symbol yvar
 $ theme      : list()
 $ coordinates:List of 1
  ..$ limits:List of 2
  .. ..$ x: NULL
  .. ..$ y: NULL
  ..- attr(<em>, &ldquo;class&rdquo;)= chr [1:2] &ldquo;cartesian&rdquo; &ldquo;coord&rdquo;
 $ facet      :List of 1
  ..$ shrink: logi TRUE
  ..- attr(</em>, &ldquo;class&rdquo;)= chr [1:2] &ldquo;null&rdquo; &ldquo;facet&rdquo;
 $ plot_env   :<environment: R_GlobalEnv> 
 $ labels     :List of 3
  ..$ x     : chr &ldquo;xvar&rdquo;
  ..$ y     : chr &ldquo;yvar&rdquo;
  ..$ colour: chr &ldquo;cond&rdquo;</p>

<ul>
<li>attr(*, &ldquo;class&rdquo;)= chr [1:2] &ldquo;gg&rdquo; &ldquo;ggplot&rdquo;
cond   xvar     yvar
1    A -4.252  3.47316
2    A  1.702  0.00594
3    A  4.323 -0.09425
4    A  1.781  2.07281
5    A 11.537  1.21544
6    A  6.672  3.60811</li>
</ul>

<p>We will need to some way to give this data to Javascript.  Javascript likes JSON, so let&#39;s use the package <a href="http://cran.r-project.org/web/packages/rjson/index.html"><code>rjson</code></a> to send our data.  I will assume that we are more comfortable flattening our data in R.</p>

<pre><code class="r">cat(
  &#39;&lt;script&gt; ourdata=&#39;,
  rjson::toJSON(apply(g4$data,MARGIN=1,FUN=function(x)return(list(x)))),
  &#39;&lt;/script&gt;&#39;
)
</code></pre>

<script> ourdata= [[{"cond":"A","xvar":"-4.252354","yvar":" 3.47316"}],[{"cond":"A","xvar":" 1.702318","yvar":" 0.00594"}],[{"cond":"A","xvar":" 4.323054","yvar":"-0.09425"}],[{"cond":"A","xvar":" 1.780628","yvar":" 2.07281"}],[{"cond":"A","xvar":"11.537348","yvar":" 1.21544"}],[{"cond":"A","xvar":" 6.672130","yvar":" 3.60811"}],[{"cond":"A","xvar":" 0.004295","yvar":" 7.52921"}],[{"cond":"A","xvar":" 9.971403","yvar":" 6.15615"}],[{"cond":"A","xvar":" 9.007456","yvar":" 8.93524"}],[{"cond":"A","xvar":"11.766998","yvar":" 8.92809"}],[{"cond":"B","xvar":" 8.840216","yvar":"13.20241"}],[{"cond":"B","xvar":" 5.974094","yvar":"17.64489"}],[{"cond":"B","xvar":"15.034829","yvar":"10.48540"}],[{"cond":"B","xvar":"10.985010","yvar":"10.13804"}],[{"cond":"B","xvar":"13.543222","yvar":"18.68188"}],[{"cond":"B","xvar":"11.435789","yvar":"19.14347"}],[{"cond":"B","xvar":"16.977063","yvar":"18.83250"}],[{"cond":"B","xvar":"17.220013","yvar":"18.93982"}],[{"cond":"B","xvar":"17.793359","yvar":"19.71859"}],[{"cond":"B","xvar":"19.319909","yvar":"19.64790"}]] </script>

<p>After this <code>ourdata</code> in Javascript should contain an array of 20 arrays, each representing the data for a point on our graph.  To show off some d3, we will get our data in perfect bindable form with this.</p>

<pre><code class="r">cat(
  &#39;&lt;script&gt; dataToBind = &#39;,
  &#39;d3.entries(ourdata.map(function(d,i) {return d[0]}))&#39;,
  &#39;&lt;/script&gt;&#39;
)
</code></pre>

<script> dataToBind =  d3.entries(ourdata.map(function(d,i) {return d[0]})) </script>

<p>Finally, we are ready for the data bind.  We used <code>gridSVG(...,addClasses=TRUE)</code> to ease our <code>d3.select</code>.  In future examples, we will see other ways we might accomplish this.</p>

<pre><code class="r">cat(
  &#39;&lt;script&gt;\n&#39;,
  &#39;scatterPoints = d3.select(&quot;.points&quot;).selectAll(&quot;use&quot;);\n&#39;,
  &#39;scatterPoints.data(dataToBind)&#39;,
  &#39;&lt;/script&gt;\n&#39;
)
</code></pre>

<script>
 scatterPoints = d3.select(".points").selectAll("use");
 scatterPoints.data(dataToBind) </script>


<script>
scatterPoints  
    .on("mouseover", function(d) {      
      //Create the tooltip label
      d3.select(this.parentNode).append("rect")
        .attr("id","tooltip")
        .attr("x",d3.select(this).attr("x"))
        .attr("y",d3.select(this).attr("y"))
        .attr("width",10)
        .attr("height",10)
        .attr("fill","blue");
        //.attr("text-anchor", "middle")
        //.text(d);
    })              
    .on("mouseout", function(d) {       
        d3.select("#tooltip").remove();  
    });
</script>

</body>

</html>

